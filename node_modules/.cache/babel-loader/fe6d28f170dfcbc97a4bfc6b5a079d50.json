{"ast":null,"code":"import playMiddle from '../assets/img/播放2.png';\nimport lastSong from '../assets/img/上一首.png';\nimport nextSong from '../assets/img/下一首.png';\nimport stop from '../assets/img/暂停.png';\nimport Pubsub from 'pubsub-js'; //引入消息订阅与发布\n\nexport default {\n  name: 'Footer',\n\n  data() {\n    return {\n      //图片\n      playMiddle,\n      lastSong,\n      nextSong,\n      stop,\n      isplay: false,\n      // musicURL:this.$store.state.musicUrl\n      //拖拽条\n      progress: 0,\n      customColor: '#409eff',\n      currentTime: 0,\n      duration: 0,\n      //订阅与发布传输过来的所有歌曲信息--对象数组\n      songs: [],\n      //订阅与发布传输过来的所有歌曲信息--当前播放歌曲的ID\n      songsID: 0,\n      // 订阅与发布传输过来的所有歌曲信息--当前播放歌曲的br\n      songsBr: 0,\n      // 当前播放歌曲的下标序列\n      currentIDIndex: 0,\n      // 左侧图片的url\n      picURL: '',\n      // 歌曲名字\n      songName: '',\n      // 歌曲作者\n      songAuthor: ''\n    };\n  },\n\n  methods: {\n    // 控制暂停播放\n    playMusic() {\n      //  const audio = window.document.querySelector('.musicAudio') //获取audio元素\n      //  console.log(audio)\n      if (this.audio.paused == true) {\n        //目前音频处于暂停状态，转为播放状态\n        this.audio.play();\n      } else this.audio.pause(); //目前音频处于播放状态，转为暂停状态\n\n\n      this.isplay = !this.isplay; //图片切换\n    },\n\n    percentageChange() {\n      //拖拽条动态变化\n      var filters = this.$options.filters; //获取全局过滤器\n\n      this.duration = filters.dataFormat1(this.audio.duration * 1000); //获取总时长\n\n      this.currentTime = filters.dataFormat1(this.audio.currentTime * 1000); //动态获取当前时间\n\n      if (this.audio.duration !== NaN) this.progress = this.audio.currentTime / this.audio.duration * 100; // 拖拽条随着timeupdate事件的发生而改变\n      //  console.log(this.percentage)\n    },\n\n    async lastSongStart() {\n      //播放上一歌曲\n      // this.getMuslicGlobal(this.songs[currentIDIndex-1].id,this.songs[currentIDIndex-1].dt)\n      Pubsub.publish('lastornext', [this.songs[this.currentIDIndex - 1].id, this.songs[this.currentIDIndex - 1].dt]);\n    },\n\n    async nextSongStart() {\n      //播放下一歌曲\n      // this.getMuslicGlobal(this.songs[currentIDIndex-1].id,this.songs[currentIDIndex-1].dt)\n      Pubsub.publish('lastornext', [this.songs[this.currentIDIndex + 1].id, this.songs[this.currentIDIndex + 1].dt]);\n    }\n\n  },\n\n  mounted() {\n    // 暂停\n    Pubsub.subscribe('stop', (msgName, data) => {\n      this.isplay = false;\n    }); // 正在播放\n\n    Pubsub.subscribe('songDetail', (msgName, data) => {\n      this.isplay = true; // console.log(typeof(this.audio.currentTime/this.audio.duration))\n      // console.log(this.percentage)\n    }); //传送歌单所有歌曲的信息，用于循环播放、上、下播放\n\n    Pubsub.subscribe('tranferSongs', async (msgName, data) => {\n      this.songs = data[0]; // console.log(this.songs[])\n\n      this.songsID = data[1];\n      this.songsBr = data[2];\n      this.currentIDIndex = await this.songs.findIndex(currentValue => {\n        return currentValue.id == this.songsID;\n      });\n      console.log(this.songs[this.currentIDIndex]);\n      this.picURL = this.songs[this.currentIDIndex].al.picUrl;\n      this.songName = this.songs[this.currentIDIndex].name;\n      this.songAuthor = this.songs[this.currentIDIndex].ar[0].name;\n    });\n  },\n\n  computed: {\n    audio() {\n      //动态获取audio标签\n      return window.document.querySelector('.musicAudio');\n    }\n\n  }\n};","map":{"version":3,"mappings":"AAkCA;AACA;AACA;AACA;AACA,+B,CAAA;;AACA;EACAA,cADA;;EAEAC;IACA;MACA;MACAC,UAFA;MAGAC,QAHA;MAIAC,QAJA;MAKAC,IALA;MAMAC,aANA;MAOA;MACA;MACAC,WATA;MAUAC,sBAVA;MAWAC,cAXA;MAYAC,WAZA;MAaA;MACAC,SAdA;MAeA;MACAC,UAhBA;MAiBA;MACAC,UAlBA;MAmBA;MACAC,iBApBA;MAqBA;MACAC,UAtBA;MAuBA;MACAC,YAxBA;MAyBA;MACAC;IA1BA;EA4BA,CA/BA;;EAgCAC;IACA;IACAC;MACA;MACA;MACA;QAAA;QACA;MAEA,CAHA,MAIA,mBAPA,CAOA;;;MACA,2BARA,CAQA;IACA,CAXA;;IAYAC;MAAA;MAEA,oCAFA,CAEA;;MACA,gEAHA,CAGA;;MACA,sEAJA,CAIA;;MACA,iCACA,mEANA,CAMA;MAGA;IACA,CAtBA;;IAuBA;MAAA;MAEA;MACAC;IACA,CA3BA;;IA4BA;MAAA;MACA;MACAA;IACA;;EA/BA,CAhCA;;EAkEAC;IACA;IACAD;MACA;IACA,CAFA,EAFA,CAKA;;IACAA;MACA,mBADA,CAEA;MACA;IACA,CAJA,EANA,CAWA;;IACAA;MACA,qBADA,CAEA;;MACA;MACA;MACA;QACA;MACA,CAFA;MAGAE;MACA;MACA;MACA;IACA,CAZA;EAaA,CA3FA;;EA4FAC;IACAC;MAAA;MACA;IACA;;EAHA;AA5FA","names":["name","data","playMiddle","lastSong","nextSong","stop","isplay","progress","customColor","currentTime","duration","songs","songsID","songsBr","currentIDIndex","picURL","songName","songAuthor","methods","playMusic","percentageChange","Pubsub","mounted","console","computed","audio"],"sourceRoot":"src/mainview","sources":["Footer.vue"],"sourcesContent":["<template>\r\n  <div class=\"bigBox\">\r\n    <el-row>\r\n        <el-col :span=\"8\" class=\"leftBox\">\r\n            <div v-if=\"picURL!=''\" class=\"leftImg\">\r\n                 <img  :src=\"picURL\" alt=\"\">\r\n            </div>\r\n            <div class=\"leftText\">\r\n                <span class=\"leftText_first\">{{songName}}</span>\r\n                <span class=\"leftText_seconed\">{{songAuthor}}</span>\r\n            </div>\r\n        </el-col>\r\n        <el-col :span=\"2\" class=\"count\"><span class=\"spanStyle\">{{currentTime}}</span></el-col>\r\n        <el-col :span=\"4\" class=\"middleControls\">\r\n            <div class=\"middleBoxHead\">\r\n                <img :src=\"this.lastSong\" alt=\"\" @click=\"lastSongStart\">\r\n                <img :src=\"this.playMiddle\" alt=\"\" @click=\"playMusic\"  v-if=\"!this.isplay\">\r\n                <img :src=\"this.stop\" @click=\"playMusic\" alt=\"\" v-else>\r\n                <img :src=\"this.nextSong\" alt=\"\" @click=\"nextSongStart \">\r\n            </div>\r\n            <div class=\"middleBoxBottom\">\r\n                \r\n                <el-slider v-model=\"progress\"></el-slider>\r\n               \r\n            </div>\r\n        </el-col>\r\n        <el-col :span=\"2\" class=\"count\"> <span class=\"spanStyle\">{{duration}}</span></el-col>\r\n        <el-col :span=\"8\"></el-col>\r\n    </el-row>\r\n    <audio :src=\"this.$store.state.musicUrl\" class=\"musicAudio\"  autoplay @timeupdate=\"percentageChange\" ></audio>\r\n  </div> \r\n</template>\r\n\r\n<script>\r\nimport playMiddle from '../assets/img/播放2.png'\r\nimport lastSong from '../assets/img/上一首.png'\r\nimport nextSong from '../assets/img/下一首.png'\r\nimport stop from '../assets/img/暂停.png'\r\nimport Pubsub from 'pubsub-js' //引入消息订阅与发布\r\nexport default {\r\n    name:'Footer',\r\n    data(){\r\n        return{\r\n            //图片\r\n            playMiddle,\r\n            lastSong,\r\n            nextSong,\r\n            stop,\r\n            isplay:false,\r\n            // musicURL:this.$store.state.musicUrl\r\n            //拖拽条\r\n            progress:0,\r\n            customColor:'#409eff',\r\n            currentTime:0,\r\n            duration:0,\r\n            //订阅与发布传输过来的所有歌曲信息--对象数组\r\n            songs:[],\r\n            //订阅与发布传输过来的所有歌曲信息--当前播放歌曲的ID\r\n            songsID:0,\r\n            // 订阅与发布传输过来的所有歌曲信息--当前播放歌曲的br\r\n            songsBr:0,\r\n            // 当前播放歌曲的下标序列\r\n            currentIDIndex:0,\r\n            // 左侧图片的url\r\n            picURL:'',\r\n            // 歌曲名字\r\n            songName:'',\r\n            // 歌曲作者\r\n            songAuthor:''\r\n        }\r\n    },\r\n    methods:{\r\n        // 控制暂停播放\r\n         playMusic(){\r\n            //  const audio = window.document.querySelector('.musicAudio') //获取audio元素\r\n            //  console.log(audio)\r\n             if(this.audio.paused==true){  //目前音频处于暂停状态，转为播放状态\r\n                this.audio.play()\r\n                \r\n             }\r\n             else this.audio.pause()  //目前音频处于播放状态，转为暂停状态\r\n             this.isplay=!this.isplay  //图片切换\r\n        },\r\n        percentageChange(){  //拖拽条动态变化\r\n\r\n                    var filters=this.$options.filters   //获取全局过滤器\r\n                    this.duration=filters.dataFormat1(this.audio.duration*1000) //获取总时长\r\n                    this.currentTime=filters.dataFormat1(this.audio.currentTime*1000)  //动态获取当前时间\r\n                    if(this.audio.duration !== NaN)\r\n                    this.progress=this.audio.currentTime/this.audio.duration*100 // 拖拽条随着timeupdate事件的发生而改变\r\n\r\n            \r\n            //  console.log(this.percentage)\r\n        },\r\n        async lastSongStart(){  //播放上一歌曲\r\n\r\n            // this.getMuslicGlobal(this.songs[currentIDIndex-1].id,this.songs[currentIDIndex-1].dt)\r\n            Pubsub.publish('lastornext',[this.songs[this.currentIDIndex-1].id,this.songs[this.currentIDIndex-1].dt])\r\n        },\r\n        async nextSongStart(){  //播放下一歌曲\r\n            // this.getMuslicGlobal(this.songs[currentIDIndex-1].id,this.songs[currentIDIndex-1].dt)\r\n            Pubsub.publish('lastornext',[this.songs[this.currentIDIndex+1].id,this.songs[this.currentIDIndex+1].dt])\r\n        }\r\n\r\n    },\r\n    mounted(){\r\n        // 暂停\r\n        Pubsub.subscribe('stop',(msgName,data)=>{\r\n            this.isplay=false\r\n        })\r\n        // 正在播放\r\n        Pubsub.subscribe('songDetail',(msgName,data)=>{\r\n            this.isplay=true\r\n            // console.log(typeof(this.audio.currentTime/this.audio.duration))\r\n            // console.log(this.percentage)\r\n        })\r\n        //传送歌单所有歌曲的信息，用于循环播放、上、下播放\r\n        Pubsub.subscribe('tranferSongs',async (msgName,data)=>{\r\n            this.songs=data[0]\r\n            // console.log(this.songs[])\r\n            this.songsID=data[1]\r\n            this.songsBr=data[2]\r\n            this.currentIDIndex = await this.songs.findIndex((currentValue)=>{\r\n                return currentValue.id==this.songsID\r\n            })\r\n            console.log(this.songs[this.currentIDIndex])\r\n            this.picURL = this.songs[this.currentIDIndex].al.picUrl\r\n            this.songName=this.songs[this.currentIDIndex].name\r\n             this.songAuthor=this.songs[this.currentIDIndex].ar[0].name\r\n        })\r\n    },\r\n    computed:{\r\n        audio(){ //动态获取audio标签\r\n            return window.document.querySelector('.musicAudio')\r\n        },\r\n\r\n\r\n        \r\n    }\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n/* 左侧 */\r\n.leftBox{\r\n    text-align: left;\r\n}\r\n.leftImg{\r\n    display: inline-block;\r\n    width: 1.5rem;\r\n    height:1.5rem;\r\n    /* text-align: left; */\r\n}\r\n.leftImg>img{\r\n    /* display: inline-block; */\r\n    width:1.5rem;\r\n    height: 1.5rem;\r\n    position: relative;\r\n    top: 0.2rem;\r\n}\r\n.leftText{\r\n    display: inline-block;\r\n    margin-left: .2rem;\r\n}\r\n.leftText>span{\r\n    display: block;\r\n}\r\n.leftText_first{\r\n    font-size: .6rem;\r\n    color: rgb(206, 206, 207);\r\n}\r\n.leftText_seconed{\r\n    font-size: .4rem;\r\n    color: rgb(206, 206, 207);\r\n}\r\n/* 中间按钮和拖拽条 */\r\n.middleControls img{\r\n    width: 1rem;\r\n    height: 1rem;\r\n}\r\n\r\n.middleBoxHead{\r\n    height: .8rem;\r\n}\r\n.middleBoxBottom{\r\n    height: 1.2rem;\r\n}\r\n/* 两个计数 */\r\n.count{\r\n    position: relative;\r\n    top: .8rem;\r\n}\r\n.spanStyle{\r\n    font-size: .4rem;\r\n    color: rgb(88, 88, 91);\r\n    font-weight: 700;\r\n}\r\n</style>"]},"metadata":{},"sourceType":"module"}